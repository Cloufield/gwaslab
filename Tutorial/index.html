<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="HE Yunye">
    
    <link rel="shortcut icon" href="../img/favicon.ico">

    
    <title>Quick Start - GWASLab</title>
    

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//rsms.me/inter/inter.css' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../css/base.min.css" rel="stylesheet">
    <link href="../css/cinder.min.css" rel="stylesheet">

    
        
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/github.min.css">
        
    
    <link href="../stylesheets/extra.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]-->

    

     
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            
              <a class="navbar-brand" href="..">GWASLab</a>
            
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../tutorial_3.3/">Tutorial for gwaslab</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Sumstats manipulation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../SumstatsObject/">SumstatsObject</a>
</li>

                        
                            
<li >
    <a href="../StatusCode/">StatusCode</a>
</li>

                        
                            
<li >
    <a href="../Standardization/">Standardization&normalization</a>
</li>

                        
                            
<li >
    <a href="../QC%26Filtering/">QC&Filtering</a>
</li>

                        
                            
<li >
    <a href="../Harmonization/">Harmonization</a>
</li>

                        
                            
<li >
    <a href="../LiftOver/">Liftover</a>
</li>

                        
                            
<li >
    <a href="../Conversion/">Data conversion</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Visualization <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../Visualization/">Manhattan & QQ plot</a>
</li>

                        
                            
<li >
    <a href="../RegionalPlot/">Regional Plot</a>
</li>

                        
                            
<li >
    <a href="../BrisbanePlot/">Brisbane Plot</a>
</li>

                        
                            
<li >
    <a href="../MiamiPlot/">Miami Plot</a>
</li>

                        
                            
<li >
    <a href="../EffectSize/">Scatter: effect size comparison</a>
</li>

                        
                            
<li >
    <a href="../AlleleFrequency/">Scatter: allele frequency comparison</a>
</li>

                        
                            
<li >
    <a href="../GeneticCorrelation/">Heatmap: genetic correlation</a>
</li>

                        
                            
<li >
    <a href="../ForestPlot/">Forest Plot</a>
</li>

                        
                            
<li >
    <a href="../Gallery/">Gallery</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Utilities <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../ExtractLead/">Extract Lead Variants</a>
</li>

                        
                            
<li >
    <a href="../ExtractNovel/">Extract Novel Variants</a>
</li>

                        
                            
<li >
    <a href="../Format/">Format & Save</a>
</li>

                        
                            
<li >
    <a href="../LoadLDSC/">Load LDSC log</a>
</li>

                        
                            
<li >
    <a href="../HeritabilityConversion/">Convert Heritability</a>
</li>

                        
                            
<li >
    <a href="../InferBuild/">Infer Genome Build</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">References <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../Download/">Download</a>
</li>

                        
                            
<li >
    <a href="../Reference/">Reference data</a>
</li>

                        
                            
<li >
    <a href="../CommonData/">Common data</a>
</li>

                        
                            
<li >
    <a href="../UpdateLogs/">Update logs</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Standardization and QC example</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../standardization_workflow/">Standardization Workflow</a>
</li>

        
            
<li >
    <a href="../quality_control_and_filtering/">QC &amp; Filtering</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Harmonization example</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../harmonization_workflow/">Workflow</a>
</li>

        
            
<li >
    <a href="../harmonization_liftover/">Liftover</a>
</li>

        
    </ul>
  </li>

                        
                            
<li >
    <a href="../format_load_save/">Formatting and saving</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Utility example</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../utility_data_conversion/">Data conversion</a>
</li>

        
            
<li >
    <a href="../utility_get_novel/">Get novel variants</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Visualization example</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../visualization_mqq/">Manhattan and Q-Q plot</a>
</li>

        
            
<li >
    <a href="../visualization_miami/">Miami plot</a>
</li>

        
            
<li >
    <a href="../visualization_regional/">Regional plot</a>
</li>

        
            
<li >
    <a href="../visualization_brisbane/">Brisbane plot</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Reference management</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../Download_reference/">Download</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="https://github.com/Cloufield/gwaslab/"><i class="fab fa-github"></i> GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#quick-start">Quick Start</a></li>
            <li class="second-level"><a href="#import-gwaslab-and-load-data">import gwaslab and load data</a></li>
                
            <li class="second-level"><a href="#quick-mqq-plot">quick mqq plot</a></li>
                
            <li class="second-level"><a href="#standardization-normalization">Standardization &amp; normalization</a></li>
                
            <li class="second-level"><a href="#fix-id">Fix ID</a></li>
                
            <li class="second-level"><a href="#extract-lead-variants">Extract lead variants</a></li>
                
            <li class="second-level"><a href="#customized-manhattan-plot">Customized manhattan plot</a></li>
                
            <li class="second-level"><a href="#regional-plot">Regional plot</a></li>
                
            <li class="second-level"><a href="#random-sampling">Random sampling</a></li>
                
            <li class="second-level"><a href="#harmonise-the-sumstats">Harmonise the sumstats</a></li>
                
            <li class="second-level"><a href="#sumstats-summary">Sumstats summary</a></li>
                
            <li class="second-level"><a href="#format-and-output">Format and Output</a></li>
                
            <li class="second-level"><a href="#liftover">Liftover</a></li>
                
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="quick-start">Quick Start</h1>
<h2 id="import-gwaslab-and-load-data">import gwaslab and load data</h2>
<p>Using a jupyter notebook, we first import gwaslab package:</p>
<pre><code class="language-python">import gwaslab as gl
</code></pre>
<p>The sample sumstats we use in this study: </p>
<pre><code class="language-bash">!wget -O t2d_bbj.txt.gz http://jenger.riken.jp/14/
</code></pre>
<p>Let's import this raw sumstats into the gwaslab Sumstats Object by specifying the necessary columns, and all data are imported as strings.
Note: you can either specify eaf (effect allele frequency) or neaf(non-effect allele frequency), if neaf is specified, it will be converted to eaf when loading sumstats.</p>
<pre><code class="language-python">mysumstats = gl.Sumstats(&quot;t2d_bbj.txt.gz&quot;,
             snpid=&quot;SNP&quot;,
             chrom=&quot;CHR&quot;,
             pos=&quot;POS&quot;,
             ea=&quot;ALT&quot;,
             nea=&quot;REF&quot;,
             neaf=&quot;Frq&quot;,
             beta=&quot;BETA&quot;,
             se=&quot;SE&quot;,
             p=&quot;P&quot;,
             direction=&quot;Dir&quot;,
             n=&quot;N&quot;,
             build=&quot;19&quot;)
</code></pre>
<p>See details in <a href="../SumstatsObject/">SumstatsObject</a>.</p>
<p>Sumstats are loaded stored as pandas DataFrame, you can check the data by </p>
<pre><code>mysumstats.data

    SNPID   CHR POS EA  NEA EAF BETA    SE  P   N   DIRECTION   STATUS
0   1:725932_G_A    1   725932  G   A   0.9960  -0.0737 0.1394  0.5970  166718  -?+-    9999999
1   1:725933_A_G    1   725933  G   A   0.0040  0.0737  0.1394  0.5973  166718  +?-+    9999999
2   1:737801_T_C    1   737801  C   T   0.0051  0.0490  0.1231  0.6908  166718  +?-+    9999999
3   1:749963_T_TAA  1   749963  TAA T   0.8374  0.0213  0.0199  0.2846  166718  -?++    9999999
4   1:751343_T_A    1   751343  T   A   0.8593  0.0172  0.0156  0.2705  166718  -?++    9999999
</code></pre>
<p>Maybe the first thing you want to check is the manhattan plot, you can do this with one line of code, gwaslab will perform a minimum QC for just the plotting. For details, please check: <a href="https://cloufield.github.io/gwaslab/Visualization/">https://cloufield.github.io/gwaslab/Visualization/</a></p>
<h2 id="quick-mqq-plot">quick mqq plot</h2>
<pre><code class="language-python">mysumstats.plot_mqq(skip=2)
</code></pre>
<p><code>skip=2</code> : skip variants with -log10P&lt;2 for plotting, which greatly improves plotting speed.</p>
<p><img alt="tutorial_mqq" src="../images/tutorial_mqq.jpg" /></p>
<h2 id="standardization-normalization">Standardization &amp; normalization</h2>
<p>It is needed to check ID,CHR,POS and alleles first before any manipulations:</p>
<p>Simply run the following function and every thing will be checked. </p>
<pre><code class="language-python">mysumstats.basic_check()
</code></pre>
<p><code>.basic_check()</code> is a wrapper of all the following basic functions, you can use these separately.</p>
<pre><code class="language-python">mysumstats.fix_ID()
mysumstats.fix_chr()
mysumstats.fix_pos()
mysumstats.fix_allele()
mysumstats.check_sanity()
mysumstats.normalize_allele()
</code></pre>
<p>See details in <a href="../Standardization/">Standardization</a>.</p>
<h2 id="fix-id">Fix ID</h2>
<p>Usually we want SNPID to be in a stadardized format chr:pos:ref:alt, we can use fix_id for this:</p>
<pre><code>mysumstats.fix_id(fixsep=True)
</code></pre>
<h2 id="extract-lead-variants">Extract lead variants</h2>
<p>Let's extract the lead variants in each significant loci to check our data. </p>
<p>The significant loci are detected based on a sliding window (default window size: 500kb)</p>
<pre><code class="language-python">mysumstats.get_lead(anno=True)
</code></pre>
<p>By specifying <code>anno=True</code> , gwaslab will also annotate the lead variant with its nearest gene names and distance.</p>
<p><strong>Note</strong>: gwaslab default genome build version is <code>build="19"</code> (GRCh37/hg19), you can change it to <code>build="38"</code> (GRCh38/hg38) when needed.</p>
<pre><code>SNPID   CHR POS EA  NEA EAF BETA    SE  P   N   DIRECTION   STATUS  LOCATION    GENE
96739   1:22068326:A:G  1   22068326    G   A   0.7550  0.0621  0.0103  1.629000e-09    191764  ++++    9960099 0   USP48
213860  1:51103268:T:C  1   51103268    C   T   0.7953  -0.0802 0.0120  2.519000e-11    191764  ----    9960099 0   FAF1
534095  1:154309595:TA:T    1   154309595   TA  T   0.0947  -0.0915 0.0166  3.289000e-08    191764  ----    9960399 0   ATP8B2
969974  2:640986:CACAT:C    2   640986  C   CACAT   0.9006  -0.0946 0.0150  2.665000e-10    191764  ----    9960399 26349   TMEM18
1091807 2:27734972:G:A  2   27734972    G   A   0.5605  0.0691  0.0088  3.897000e-15    191764  ++++    9960099 0   GCKR
</code></pre>
<p>See details in <a href="https://cloufield.github.io/gwaslab/ExtractLead/">ExtractLead</a>.</p>
<h2 id="customized-manhattan-plot">Customized manhattan plot</h2>
<p>GWASlab can plot more complicated manhattan plot.</p>
<p>For details, please check: <a href="https://cloufield.github.io/gwaslab/Visualization/">https://cloufield.github.io/gwaslab/Visualization/</a></p>
<pre><code class="language-python">mysumstats.plot_mqq(snpid=&quot;SNPID&quot;,mode=&quot;mqq&quot;,
                  cut=20,skip=3, eaf=&quot;EAF&quot;,
                  anno=True,anno_set=[&quot;9:22132729_A_G&quot;,&quot;6:20688121_T_A&quot;,&quot;9:22132729_A_G&quot;,&quot;15:62394264_G_C&quot;] ,
                  pinpoint=[&quot;9:22132729_A_G&quot;,&quot;5:176513896_C_A&quot;], 
                  highlight=[&quot;7:127253550_C_T&quot;,&quot;19:46166604_C_T&quot;],
                  highlight_windowkb =1000,
                  stratified=True,
                  marker_size=(5,10),
                  figargs={&quot;figsize&quot;:(15,5),&quot;dpi&quot;:300})
</code></pre>
<p><img width=800, src="https://user-images.githubusercontent.com/40289485/197334325-47845b3b-0f00-4a1e-8822-aa92582850b2.png"></p>
<p>See details in <a href="../Visualization/">Visualization</a>.</p>
<h2 id="regional-plot">Regional plot</h2>
<p>Quick regional plot without LD-information</p>
<pre><code>mysumstats.plot_mqq(mode=&quot;r&quot;,region=(7,156538803,157538803),region_grid=True)
</code></pre>
<p><strong>Note</strong>: gwaslab default genome build version is <code>build="19"</code> (GRCh37/hg19), you can change it to <code>build="38"</code> (GRCh38/hg38) when needed.
For gene tracks, default is <code>gtf_path="ensembl"</code> , you can also use <code>gtf_path="refseq"</code> (NCBA RefSeq)</p>
<p><img width=800, src="https://user-images.githubusercontent.com/40289485/197334277-881afe29-f52c-4579-bbe4-967780de3777.png"></p>
<p>Full regional plot using a user-provided vcf 
(e.g 1000 genome, see Reference: <a href="https://cloufield.github.io/gwaslab/Reference/">https://cloufield.github.io/gwaslab/Reference/)</a>)</p>
<pre><code>mysumstats.plot_mqq(mode=&quot;r&quot;,region=(7,156538803,157538803),region_grid=True,anno=True,
                    vcf_path=&quot;/Users/he/Documents/Mydata/eas_1kg_af/EAS.chr7.split_norm_af.1kgp3v5.vcf.gz&quot;)
</code></pre>
<p><img width=800, src="https://user-images.githubusercontent.com/40289485/197334417-acc8eaee-7e34-42c6-9d06-3449e76a3484.png"></p>
<h2 id="random-sampling">Random sampling</h2>
<p>There are more than 10 million variants in the original sumstats and it will take long to process the entrie dataset. 
Since it might take a while to process the entire datasets, let us just random sample 1 million variants for this tutorial.</p>
<pre><code>mysumstats.random_variants(n=100000)
</code></pre>
<h2 id="harmonise-the-sumstats">Harmonise the sumstats</h2>
<ul>
<li>ref_seq : reference genome fasta file for allele alignment</li>
<li>ref_rsid_tsv : tsv file for annotation of common used variants</li>
<li>ref_rsid_vcf : vcf file for annotation of other variants</li>
<li>ref_infer : vcf file with allele frequency information for inferring strand and comparing allele frequency </li>
<li>ref_alt_freq : field in INFO of vcf file for alternative allele frequency</li>
</ul>
<p>For details see: <a href="https://cloufield.github.io/gwaslab/Harmonization/">https://cloufield.github.io/gwaslab/Harmonization/</a></p>
<pre><code>mysumstats.harmonize(basic_check=False,
                    n_cores=3,
                    ref_seq=&quot;/Users/he/Documents/Mydata/human_g1k_v37.fasta&quot;,
                    ref_rsid_tsv=&quot;/Users/he/Documents/Mydata/EAS_1kg_af_dbsnp151.ALL.tsv&quot;,
                    ref_rsid_vcf=&quot;/Users/he/Documents/Mydata/All_20180423.vcf.gz&quot;,
                    ref_infer=&quot;/Users/he/Documents/Mydata/eas_1kg_af/EAS.ALL.split_norm_af.1kgp3v5.hg19.vcf.gz&quot;,ref_alt_freq=&quot;AF&quot;)
</code></pre>
<p>gwaslab will then harmonize the sumstats based on reference files. </p>
<pre><code>Fri Oct 21 16:05:39 2022 Start to check if NEA is aligned with reference sequence...
Fri Oct 21 16:05:39 2022  -Current Dataframe shape : 100000  x  12
Fri Oct 21 16:05:39 2022  -Reference genome fasta file: /Users/he/Documents/Mydata/human_g1k_v37.fasta
Fri Oct 21 16:05:39 2022  -Checking records: 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  X  Y  MT  
Fri Oct 21 16:06:11 2022  -Variants allele on given reference sequence :  41646
Fri Oct 21 16:06:11 2022  -Variants flipped :  50095
Fri Oct 21 16:06:11 2022   -Raw Matching rate :  91.74%
Fri Oct 21 16:06:11 2022  -Variants inferred reverse_complement :  0
Fri Oct 21 16:06:11 2022  -Variants inferred reverse_complement_flipped :  0
Fri Oct 21 16:06:11 2022  -Both allele on genome + unable to distinguish :  8259
Fri Oct 21 16:06:11 2022  -Variants not on given reference sequence :  0
Fri Oct 21 16:06:11 2022  -Current Dataframe shape : 100000  x  12
Fri Oct 21 16:06:12 2022 Start to flip allele-specific stats for SNPs with status xxxxx[35]x: alt-&gt;ea , ref-&gt;nea ... 
Fri Oct 21 16:06:12 2022  -Flipping 50095 variants...
Fri Oct 21 16:06:12 2022  -Swapping column: NEA &lt;=&gt; EA...
Fri Oct 21 16:06:12 2022  -Flipping column: BETA = - BETA...
Fri Oct 21 16:06:12 2022  -Flipping column: EAF = 1 - EAF...
Fri Oct 21 16:06:12 2022  -Flipping column: DIRECTION +-? &lt;=&gt; -+? ...
Fri Oct 21 16:06:13 2022  -Changed the status for flipped variants : xxxxx[35]x -&gt; xxxxx[12]x
Fri Oct 21 16:06:13 2022 Finished converting successfully!
Fri Oct 21 16:06:13 2022 Start to infer strand for palindromic SNPs...
Fri Oct 21 16:06:13 2022  -Current Dataframe shape : 100000  x  12
Fri Oct 21 16:06:13 2022  -Reference vcf file: /Users/he/Documents/Mydata/eas_1kg_af/EAS.ALL.split_norm_af.1kgp3v5.hg19.vcf.gz
Fri Oct 21 16:06:13 2022  -Alternative allele frequency in INFO: AF
Fri Oct 21 16:06:14 2022  -Identified  14046  palindromic SNPs...
Fri Oct 21 16:06:14 2022  -After filtering by MAF&lt;  0.4  , the strand of  12814  palindromic SNPs will be inferred...
Fri Oct 21 16:06:36 2022   -Non-palindromic :  76945
Fri Oct 21 16:06:36 2022   -Palindromic SNPs on + strand:  12456
Fri Oct 21 16:06:37 2022   -Palindromic SNPs on - strand and need to be flipped: 22
Fri Oct 21 16:06:37 2022   -Palindromic SNPs with maf not availble to infer :  1232
Fri Oct 21 16:06:37 2022   -Palindromic SNPs with no macthes or no information :  186
Fri Oct 21 16:06:38 2022  -Identified  8259  indistinguishable Indels...
Fri Oct 21 16:06:38 2022  -Indistinguishable Indels will be inferred from reference vcf ref and alt...
Fri Oct 21 16:07:11 2022   -Indels ea/nea match reference :  3520
Fri Oct 21 16:07:11 2022   -Indels ea/nea need to be flipped :  4468
Fri Oct 21 16:07:11 2022   -Indels with no macthes or no information :  271
Fri Oct 21 16:07:11 2022  -Current Dataframe shape : 100000  x  12
Fri Oct 21 16:07:12 2022 Start to flip allele-specific stats for standardized indels with status xxxx[123][67][6]: alt-&gt;ea , ref-&gt;nea ... 
Fri Oct 21 16:07:12 2022  -Flipping 4468 variants...
Fri Oct 21 16:07:13 2022  -Swapping column: NEA &lt;=&gt; EA...
Fri Oct 21 16:07:13 2022  -Flipping column: BETA = - BETA...
Fri Oct 21 16:07:13 2022  -Flipping column: EAF = 1 - EAF...
Fri Oct 21 16:07:13 2022  -Flipping column: DIRECTION +-? &lt;=&gt; -+? ...
Fri Oct 21 16:07:13 2022  -Changed the status for flipped variants xxxx[123][67]6 -&gt; xxxx[123][67]4
Fri Oct 21 16:07:13 2022 Start to flip allele-specific stats for palindromic SNPs with status xxxxx[12]5: (-)strand &lt;=&gt; (+)strand ... 
Fri Oct 21 16:07:13 2022  -Flipping 22 variants...
Fri Oct 21 16:07:13 2022  -Flipping column: BETA = - BETA...
Fri Oct 21 16:07:13 2022  -Flipping column: EAF = 1 - EAF...
Fri Oct 21 16:07:13 2022  -Flipping column: DIRECTION +-? &lt;=&gt; -+? ...
Fri Oct 21 16:07:13 2022  -Changed the status for flipped variants:  xxxxx[012]5: -&gt;  xxxxx[012]2
Fri Oct 21 16:07:13 2022 Finished converting successfully!
Fri Oct 21 16:07:13 2022 Start to annotate rsID based on chromosome and position information...
Fri Oct 21 16:07:13 2022  -Current Dataframe shape : 100000  x  12
Fri Oct 21 16:07:13 2022  -SNPID-rsID text file: /Users/he/Documents/Mydata/EAS_1kg_af_dbsnp151.ALL.tsv
Fri Oct 21 16:07:13 2022  -100000 rsID could be possibly fixed...
Fri Oct 21 16:07:14 2022  -Setting block size:  5000000
Fri Oct 21 16:07:14 2022  -Loading block: 0   1   2   3   4   5   6   7   8   9   10   11   12   13   14   15   16   
Fri Oct 21 16:11:57 2022  -rsID Annotation for 3250 need to be fixed!
Fri Oct 21 16:11:57 2022  -Annotated 96750 rsID successfully!
Fri Oct 21 16:11:57 2022 Start to assign rsID using vcf...
Fri Oct 21 16:11:57 2022  -Current Dataframe shape : 100000  x  13
Fri Oct 21 16:11:57 2022  -CPU Cores to use : 3
Fri Oct 21 16:11:57 2022  -Reference VCF file: /Users/he/Documents/Mydata/All_20180423.vcf.gz
Fri Oct 21 16:11:57 2022  -Assigning rsID based on chr:pos and ref:alt/alt:ref...
Fri Oct 21 16:12:18 2022  -rsID Annotation for 582 need to be fixed!
Fri Oct 21 16:12:18 2022  -Annotated 2668 rsID successfully!
Fri Oct 21 16:12:18 2022 Start to sort the genome coordinates...
Fri Oct 21 16:12:18 2022  -Current Dataframe shape : 100000  x  13
Fri Oct 21 16:12:18 2022  -Force converting POS to integers...
Fri Oct 21 16:12:18 2022  -Sorting genome coordinates...
Fri Oct 21 16:12:18 2022 Finished sorting genome coordinates successfully!
Fri Oct 21 16:12:18 2022 Start to reorder the columns...
Fri Oct 21 16:12:18 2022  -Current Dataframe shape : 100000  x  13
Fri Oct 21 16:12:18 2022  -Reordering columns to    : SNPID,rsID,CHR,POS,EA,NEA,EAF,BETA,SE,P,N,DIRECTION,STATUS
Fri Oct 21 16:12:18 2022 Finished sorting columns successfully!
</code></pre>
<h2 id="sumstats-summary">Sumstats summary</h2>
<p>You can check the summary of your sumstats by:</p>
<pre><code>mysumstats.summary()
</code></pre>
<h2 id="format-and-output">Format and Output</h2>
<p>You can then foremat your sumstats and output.</p>
<p>gwaslab support commonly used formats. For details see: <a href="https://cloufield.github.io/gwaslab/Format/">https://cloufield.github.io/gwaslab/Format/</a></p>
<pre><code>mysumstats.to_format(&quot;clean_sumstats&quot;,fmt=&quot;ldsc&quot;)
</code></pre>
<hr />
<h2 id="liftover">Liftover</h2>
<pre><code class="language-python">mysumstats.liftover(n_cores=1,from_build=&quot;19&quot;, to_build=&quot;38&quot;)
</code></pre>
<p>Gwaslab only liftover CHR and POS, and when lifted, the last two digits status code will be rolled back to 99. Since for difference reference genome, the reference allele or strand might be reverse, so it is need to align and check agin. </p>
<p>See details in <a href="../Harmonization/">Harmonization</a>.</p></div>
        
        
    </div>

    
      <footer class="col-md-12 text-center">
          
          
            <hr>
            <p>
            <small>GWASLab is licensed under the MIT license</small><br>
            
            <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</small>
            </p>
          

          
          
      </footer>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>

    
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js"></script>
        
    <script>hljs.initHighlightingOnLoad();</script>
    

    <script>var base_url = ".."</script>
    
    <script src="../js/base.js"></script>

    <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    </body>

</html>
