
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="HE Yunye">
      
      
      
      
      <link rel="icon" href="../assets/gwaslab.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.6">
    
    
      
        <title>Quick Start - GWASLab</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quick-start" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="GWASLab" class="md-header__button md-logo" aria-label="GWASLab" data-md-component="logo">
      
  <img src="../assets/gwaslab.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GWASLab
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Quick Start
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Cloufield/gwaslab/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../tutorial_3.4/" class="md-tabs__link">
      Tutorial for gwaslab
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../SumstatsObject/" class="md-tabs__link">
        Sumstats manipulation
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../Visualization/" class="md-tabs__link">
        Visualization
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../ExtractLead/" class="md-tabs__link">
        Utilities
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../Download/" class="md-tabs__link">
        References
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="GWASLab" class="md-nav__button md-logo" aria-label="GWASLab" data-md-component="logo">
      
  <img src="../assets/gwaslab.png" alt="logo">

    </a>
    GWASLab
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Cloufield/gwaslab/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UpdateLogs/" class="md-nav__link">
        Update logs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_3.4/" class="md-nav__link">
        Tutorial for gwaslab
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Sumstats manipulation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Sumstats manipulation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../SumstatsObject/" class="md-nav__link">
        Sumstats Object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../StatusCode/" class="md-nav__link">
        Status Code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Standardization/" class="md-nav__link">
        Standardization and Normalization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../QC%26Filtering/" class="md-nav__link">
        QC and Filtering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Harmonization/" class="md-nav__link">
        Harmonization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../AssignrsID/" class="md-nav__link">
        Assigning rsID
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../AssignCHRPOS/" class="md-nav__link">
        Assign CHR/POS using rsID
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../LiftOver/" class="md-nav__link">
        Liftover
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Conversion/" class="md-nav__link">
        Data conversion
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Visualization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Visualization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Visualization/" class="md-nav__link">
        Manhattan and QQ plot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../RegionalPlot/" class="md-nav__link">
        Regional Plot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../BrisbanePlot/" class="md-nav__link">
        Brisbane Plot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MiamiPlot/" class="md-nav__link">
        Miami Plot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../EffectSize/" class="md-nav__link">
        Effect Size Comparison
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ExtractLead/" class="md-nav__link">
        Extract Lead Variants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ExtractNovel/" class="md-nav__link">
        Extract Novel Variants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Format/" class="md-nav__link">
        Format and Save
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Pickle/" class="md-nav__link">
        Save Sumstats Object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../LoadLDSC/" class="md-nav__link">
        Load LDSC log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../HeritabilityConversion/" class="md-nav__link">
        Convert Heritability
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../PerSNPh2/" class="md-nav__link">
        Per SNP Heritability and F statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../InferBuild/" class="md-nav__link">
        Infer Genome Build
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          References
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          References
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Download/" class="md-nav__link">
        Download
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/" class="md-nav__link">
        Reference data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CommonData/" class="md-nav__link">
        Common data
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#import-gwaslab-and-load-data" class="md-nav__link">
    import gwaslab and load data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-mqq-plot" class="md-nav__link">
    quick mqq plot
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#standardization-normalization" class="md-nav__link">
    Standardization &amp; normalization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fix-id" class="md-nav__link">
    Fix ID
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extract-lead-variants" class="md-nav__link">
    Extract lead variants
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customized-manhattan-plot" class="md-nav__link">
    Customized manhattan plot
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regional-plot" class="md-nav__link">
    Regional plot
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#random-sampling" class="md-nav__link">
    Random sampling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#harmonise-the-sumstats" class="md-nav__link">
    Harmonise the sumstats
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumstats-summary" class="md-nav__link">
    Sumstats summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#format-and-output" class="md-nav__link">
    Format and Output
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#liftover" class="md-nav__link">
    Liftover
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="quick-start">Quick Start</h1>
<h2 id="import-gwaslab-and-load-data">import gwaslab and load data</h2>
<p>Using a jupyter notebook, we first import gwaslab package:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">gwaslab</span> <span class="k">as</span> <span class="nn">gl</span>
</code></pre></div>
<p>The sample sumstats we use in this study: </p>
<div class="highlight"><pre><span></span><code>!wget<span class="w"> </span>-O<span class="w"> </span>t2d_bbj.txt.gz<span class="w"> </span>http://jenger.riken.jp/14/
</code></pre></div>
<p>Let's import this raw sumstats into the gwaslab Sumstats Object by specifying the necessary columns, and all data are imported as strings.
Note: you can either specify eaf (effect allele frequency) or neaf(non-effect allele frequency), if neaf is specified, it will be converted to eaf when loading sumstats.
<div class="highlight"><pre><span></span><code><span class="n">mysumstats</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">Sumstats</span><span class="p">(</span><span class="s2">&quot;t2d_bbj.txt.gz&quot;</span><span class="p">,</span>
             <span class="n">snpid</span><span class="o">=</span><span class="s2">&quot;SNP&quot;</span><span class="p">,</span>
             <span class="n">chrom</span><span class="o">=</span><span class="s2">&quot;CHR&quot;</span><span class="p">,</span>
             <span class="n">pos</span><span class="o">=</span><span class="s2">&quot;POS&quot;</span><span class="p">,</span>
             <span class="n">ea</span><span class="o">=</span><span class="s2">&quot;ALT&quot;</span><span class="p">,</span>
             <span class="n">nea</span><span class="o">=</span><span class="s2">&quot;REF&quot;</span><span class="p">,</span>
             <span class="n">neaf</span><span class="o">=</span><span class="s2">&quot;Frq&quot;</span><span class="p">,</span>
             <span class="n">beta</span><span class="o">=</span><span class="s2">&quot;BETA&quot;</span><span class="p">,</span>
             <span class="n">se</span><span class="o">=</span><span class="s2">&quot;SE&quot;</span><span class="p">,</span>
             <span class="n">p</span><span class="o">=</span><span class="s2">&quot;P&quot;</span><span class="p">,</span>
             <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;Dir&quot;</span><span class="p">,</span>
             <span class="n">n</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>
             <span class="n">build</span><span class="o">=</span><span class="s2">&quot;19&quot;</span><span class="p">)</span>
</code></pre></div>
See details in <a href="../SumstatsObject/">SumstatsObject</a>.</p>
<p>Sumstats are loaded stored as pandas DataFrame, you can check the data by 
<div class="highlight"><pre><span></span><code>mysumstats.data

    SNPID   CHR POS EA  NEA EAF BETA    SE  P   N   DIRECTION   STATUS
0   1:725932_G_A    1   725932  G   A   0.9960  -0.0737 0.1394  0.5970  166718  -?+-    9999999
1   1:725933_A_G    1   725933  G   A   0.0040  0.0737  0.1394  0.5973  166718  +?-+    9999999
2   1:737801_T_C    1   737801  C   T   0.0051  0.0490  0.1231  0.6908  166718  +?-+    9999999
3   1:749963_T_TAA  1   749963  TAA T   0.8374  0.0213  0.0199  0.2846  166718  -?++    9999999
4   1:751343_T_A    1   751343  T   A   0.8593  0.0172  0.0156  0.2705  166718  -?++    9999999
</code></pre></div></p>
<p>Maybe the first thing you want to check is the manhattan plot, you can do this with one line of code, gwaslab will perform a minimum QC for just the plotting. For details, please check: <a href="https://cloufield.github.io/gwaslab/Visualization/">https://cloufield.github.io/gwaslab/Visualization/</a></p>
<h2 id="quick-mqq-plot">quick mqq plot</h2>
<p><div class="highlight"><pre><span></span><code><span class="n">mysumstats</span><span class="o">.</span><span class="n">plot_mqq</span><span class="p">(</span><span class="n">skip</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<code>skip=2</code> : skip variants with -log10P&lt;2 for plotting, which greatly improves plotting speed.</p>
<p><img alt="tutorial_mqq" src="../images/tutorial_mqq.jpg" /></p>
<h2 id="standardization-normalization">Standardization &amp; normalization</h2>
<p>It is needed to check ID,CHR,POS and alleles first before any manipulations:</p>
<p>Simply run the following function and every thing will be checked. </p>
<div class="highlight"><pre><span></span><code><span class="n">mysumstats</span><span class="o">.</span><span class="n">basic_check</span><span class="p">()</span>
</code></pre></div>
<p><code>.basic_check()</code> is a wrapper of all the following basic functions, you can use these separately.</p>
<p><div class="highlight"><pre><span></span><code><span class="n">mysumstats</span><span class="o">.</span><span class="n">fix_ID</span><span class="p">()</span>
<span class="n">mysumstats</span><span class="o">.</span><span class="n">fix_chr</span><span class="p">()</span>
<span class="n">mysumstats</span><span class="o">.</span><span class="n">fix_pos</span><span class="p">()</span>
<span class="n">mysumstats</span><span class="o">.</span><span class="n">fix_allele</span><span class="p">()</span>
<span class="n">mysumstats</span><span class="o">.</span><span class="n">check_sanity</span><span class="p">()</span>
<span class="n">mysumstats</span><span class="o">.</span><span class="n">normalize_allele</span><span class="p">()</span>
</code></pre></div>
See details in <a href="../Standardization/">Standardization</a>.</p>
<h2 id="fix-id">Fix ID</h2>
<p>Usually we want SNPID to be in a stadardized format chr:pos:ref:alt, we can use fix_id for this:</p>
<div class="highlight"><pre><span></span><code>mysumstats.fix_id(fixsep=True)
</code></pre></div>
<h2 id="extract-lead-variants">Extract lead variants</h2>
<p>Let's extract the lead variants in each significant loci to check our data. </p>
<p>The significant loci are detected based on a sliding window (default window size: 500kb)</p>
<div class="highlight"><pre><span></span><code><span class="n">mysumstats</span><span class="o">.</span><span class="n">get_lead</span><span class="p">(</span><span class="n">anno</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p>By specifying <code>anno=True</code> , gwaslab will also annotate the lead variant with its nearest gene names and distance.</p>
<p><strong>Note</strong>: gwaslab default genome build version is <code>build="19"</code> (GRCh37/hg19), you can change it to <code>build="38"</code> (GRCh38/hg38) when needed.</p>
<div class="highlight"><pre><span></span><code>SNPID   CHR POS EA  NEA EAF BETA    SE  P   N   DIRECTION   STATUS  LOCATION    GENE
96739   1:22068326:A:G  1   22068326    G   A   0.7550  0.0621  0.0103  1.629000e-09    191764  ++++    9960099 0   USP48
213860  1:51103268:T:C  1   51103268    C   T   0.7953  -0.0802 0.0120  2.519000e-11    191764  ----    9960099 0   FAF1
534095  1:154309595:TA:T    1   154309595   TA  T   0.0947  -0.0915 0.0166  3.289000e-08    191764  ----    9960399 0   ATP8B2
969974  2:640986:CACAT:C    2   640986  C   CACAT   0.9006  -0.0946 0.0150  2.665000e-10    191764  ----    9960399 26349   TMEM18
1091807 2:27734972:G:A  2   27734972    G   A   0.5605  0.0691  0.0088  3.897000e-15    191764  ++++    9960099 0   GCKR
</code></pre></div>
<p>See details in <a href="https://cloufield.github.io/gwaslab/ExtractLead/">ExtractLead</a>.</p>
<h2 id="customized-manhattan-plot">Customized manhattan plot</h2>
<p>GWASlab can plot more complicated manhattan plot.</p>
<p>For details, please check: <a href="https://cloufield.github.io/gwaslab/Visualization/">https://cloufield.github.io/gwaslab/Visualization/</a></p>
<div class="highlight"><pre><span></span><code><span class="n">mysumstats</span><span class="o">.</span><span class="n">plot_mqq</span><span class="p">(</span><span class="n">snpid</span><span class="o">=</span><span class="s2">&quot;SNPID&quot;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;mqq&quot;</span><span class="p">,</span>
                  <span class="n">cut</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">skip</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">eaf</span><span class="o">=</span><span class="s2">&quot;EAF&quot;</span><span class="p">,</span>
                  <span class="n">anno</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">anno_set</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;9:22132729_A_G&quot;</span><span class="p">,</span><span class="s2">&quot;6:20688121_T_A&quot;</span><span class="p">,</span><span class="s2">&quot;9:22132729_A_G&quot;</span><span class="p">,</span><span class="s2">&quot;15:62394264_G_C&quot;</span><span class="p">]</span> <span class="p">,</span>
                  <span class="n">pinpoint</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;9:22132729_A_G&quot;</span><span class="p">,</span><span class="s2">&quot;5:176513896_C_A&quot;</span><span class="p">],</span> 
                  <span class="n">highlight</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;7:127253550_C_T&quot;</span><span class="p">,</span><span class="s2">&quot;19:46166604_C_T&quot;</span><span class="p">],</span>
                  <span class="n">highlight_windowkb</span> <span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                  <span class="n">stratified</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">marker_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
                  <span class="n">figargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="s2">&quot;dpi&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">})</span>
</code></pre></div>
<p><img width=800, src="https://user-images.githubusercontent.com/40289485/197334325-47845b3b-0f00-4a1e-8822-aa92582850b2.png"></p>
<p>See details in <a href="../Visualization/">Visualization</a>.</p>
<h2 id="regional-plot">Regional plot</h2>
<p>Quick regional plot without LD-information
<div class="highlight"><pre><span></span><code>mysumstats.plot_mqq(mode=&quot;r&quot;,region=(7,156538803,157538803),region_grid=True)
</code></pre></div></p>
<p><strong>Note</strong>: gwaslab default genome build version is <code>build="19"</code> (GRCh37/hg19), you can change it to <code>build="38"</code> (GRCh38/hg38) when needed.
For gene tracks, default is <code>gtf_path="ensembl"</code> , you can also use <code>gtf_path="refseq"</code> (NCBA RefSeq)</p>
<p><img width=800, src="https://user-images.githubusercontent.com/40289485/197334277-881afe29-f52c-4579-bbe4-967780de3777.png"></p>
<p>Full regional plot using a user-provided vcf 
(e.g 1000 genome, see Reference: <a href="https://cloufield.github.io/gwaslab/Reference/">https://cloufield.github.io/gwaslab/Reference/)</a>)</p>
<div class="highlight"><pre><span></span><code>mysumstats.plot_mqq(mode=&quot;r&quot;,region=(7,156538803,157538803),region_grid=True,anno=True,
                    vcf_path=&quot;/Users/he/Documents/Mydata/eas_1kg_af/EAS.chr7.split_norm_af.1kgp3v5.vcf.gz&quot;)
</code></pre></div>
<p><img width=800, src="https://user-images.githubusercontent.com/40289485/197334417-acc8eaee-7e34-42c6-9d06-3449e76a3484.png"></p>
<h2 id="random-sampling">Random sampling</h2>
<p>There are more than 10 million variants in the original sumstats and it will take long to process the entrie dataset. 
Since it might take a while to process the entire datasets, let us just random sample 1 million variants for this tutorial.</p>
<div class="highlight"><pre><span></span><code>mysumstats.random_variants(n=100000)
</code></pre></div>
<h2 id="harmonise-the-sumstats">Harmonise the sumstats</h2>
<ul>
<li>ref_seq : reference genome fasta file for allele alignment</li>
<li>ref_rsid_tsv : tsv file for annotation of common used variants</li>
<li>ref_rsid_vcf : vcf file for annotation of other variants</li>
<li>ref_infer : vcf file with allele frequency information for inferring strand and comparing allele frequency </li>
<li>ref_alt_freq : field in INFO of vcf file for alternative allele frequency</li>
</ul>
<p>For details see: <a href="https://cloufield.github.io/gwaslab/Harmonization/">https://cloufield.github.io/gwaslab/Harmonization/</a></p>
<p><div class="highlight"><pre><span></span><code>mysumstats.harmonize(basic_check=False,
                    n_cores=3,
                    ref_seq=&quot;/Users/he/Documents/Mydata/human_g1k_v37.fasta&quot;,
                    ref_rsid_tsv=&quot;/Users/he/Documents/Mydata/EAS_1kg_af_dbsnp151.ALL.tsv&quot;,
                    ref_rsid_vcf=&quot;/Users/he/Documents/Mydata/All_20180423.vcf.gz&quot;,
                    ref_infer=&quot;/Users/he/Documents/Mydata/eas_1kg_af/EAS.ALL.split_norm_af.1kgp3v5.hg19.vcf.gz&quot;,ref_alt_freq=&quot;AF&quot;)
</code></pre></div>
gwaslab will then harmonize the sumstats based on reference files. 
<div class="highlight"><pre><span></span><code>Fri Oct 21 16:05:39 2022 Start to check if NEA is aligned with reference sequence...
Fri Oct 21 16:05:39 2022  -Current Dataframe shape : 100000  x  12
Fri Oct 21 16:05:39 2022  -Reference genome fasta file: /Users/he/Documents/Mydata/human_g1k_v37.fasta
Fri Oct 21 16:05:39 2022  -Checking records: 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  X  Y  MT  
Fri Oct 21 16:06:11 2022  -Variants allele on given reference sequence :  41646
Fri Oct 21 16:06:11 2022  -Variants flipped :  50095
Fri Oct 21 16:06:11 2022   -Raw Matching rate :  91.74%
Fri Oct 21 16:06:11 2022  -Variants inferred reverse_complement :  0
Fri Oct 21 16:06:11 2022  -Variants inferred reverse_complement_flipped :  0
Fri Oct 21 16:06:11 2022  -Both allele on genome + unable to distinguish :  8259
Fri Oct 21 16:06:11 2022  -Variants not on given reference sequence :  0
Fri Oct 21 16:06:11 2022  -Current Dataframe shape : 100000  x  12
Fri Oct 21 16:06:12 2022 Start to flip allele-specific stats for SNPs with status xxxxx[35]x: alt-&gt;ea , ref-&gt;nea ... 
Fri Oct 21 16:06:12 2022  -Flipping 50095 variants...
Fri Oct 21 16:06:12 2022  -Swapping column: NEA &lt;=&gt; EA...
Fri Oct 21 16:06:12 2022  -Flipping column: BETA = - BETA...
Fri Oct 21 16:06:12 2022  -Flipping column: EAF = 1 - EAF...
Fri Oct 21 16:06:12 2022  -Flipping column: DIRECTION +-? &lt;=&gt; -+? ...
Fri Oct 21 16:06:13 2022  -Changed the status for flipped variants : xxxxx[35]x -&gt; xxxxx[12]x
Fri Oct 21 16:06:13 2022 Finished converting successfully!
Fri Oct 21 16:06:13 2022 Start to infer strand for palindromic SNPs...
Fri Oct 21 16:06:13 2022  -Current Dataframe shape : 100000  x  12
Fri Oct 21 16:06:13 2022  -Reference vcf file: /Users/he/Documents/Mydata/eas_1kg_af/EAS.ALL.split_norm_af.1kgp3v5.hg19.vcf.gz
Fri Oct 21 16:06:13 2022  -Alternative allele frequency in INFO: AF
Fri Oct 21 16:06:14 2022  -Identified  14046  palindromic SNPs...
Fri Oct 21 16:06:14 2022  -After filtering by MAF&lt;  0.4  , the strand of  12814  palindromic SNPs will be inferred...
Fri Oct 21 16:06:36 2022   -Non-palindromic :  76945
Fri Oct 21 16:06:36 2022   -Palindromic SNPs on + strand:  12456
Fri Oct 21 16:06:37 2022   -Palindromic SNPs on - strand and need to be flipped: 22
Fri Oct 21 16:06:37 2022   -Palindromic SNPs with maf not availble to infer :  1232
Fri Oct 21 16:06:37 2022   -Palindromic SNPs with no macthes or no information :  186
Fri Oct 21 16:06:38 2022  -Identified  8259  indistinguishable Indels...
Fri Oct 21 16:06:38 2022  -Indistinguishable Indels will be inferred from reference vcf ref and alt...
Fri Oct 21 16:07:11 2022   -Indels ea/nea match reference :  3520
Fri Oct 21 16:07:11 2022   -Indels ea/nea need to be flipped :  4468
Fri Oct 21 16:07:11 2022   -Indels with no macthes or no information :  271
Fri Oct 21 16:07:11 2022  -Current Dataframe shape : 100000  x  12
Fri Oct 21 16:07:12 2022 Start to flip allele-specific stats for standardized indels with status xxxx[123][67][6]: alt-&gt;ea , ref-&gt;nea ... 
Fri Oct 21 16:07:12 2022  -Flipping 4468 variants...
Fri Oct 21 16:07:13 2022  -Swapping column: NEA &lt;=&gt; EA...
Fri Oct 21 16:07:13 2022  -Flipping column: BETA = - BETA...
Fri Oct 21 16:07:13 2022  -Flipping column: EAF = 1 - EAF...
Fri Oct 21 16:07:13 2022  -Flipping column: DIRECTION +-? &lt;=&gt; -+? ...
Fri Oct 21 16:07:13 2022  -Changed the status for flipped variants xxxx[123][67]6 -&gt; xxxx[123][67]4
Fri Oct 21 16:07:13 2022 Start to flip allele-specific stats for palindromic SNPs with status xxxxx[12]5: (-)strand &lt;=&gt; (+)strand ... 
Fri Oct 21 16:07:13 2022  -Flipping 22 variants...
Fri Oct 21 16:07:13 2022  -Flipping column: BETA = - BETA...
Fri Oct 21 16:07:13 2022  -Flipping column: EAF = 1 - EAF...
Fri Oct 21 16:07:13 2022  -Flipping column: DIRECTION +-? &lt;=&gt; -+? ...
Fri Oct 21 16:07:13 2022  -Changed the status for flipped variants:  xxxxx[012]5: -&gt;  xxxxx[012]2
Fri Oct 21 16:07:13 2022 Finished converting successfully!
Fri Oct 21 16:07:13 2022 Start to annotate rsID based on chromosome and position information...
Fri Oct 21 16:07:13 2022  -Current Dataframe shape : 100000  x  12
Fri Oct 21 16:07:13 2022  -SNPID-rsID text file: /Users/he/Documents/Mydata/EAS_1kg_af_dbsnp151.ALL.tsv
Fri Oct 21 16:07:13 2022  -100000 rsID could be possibly fixed...
Fri Oct 21 16:07:14 2022  -Setting block size:  5000000
Fri Oct 21 16:07:14 2022  -Loading block: 0   1   2   3   4   5   6   7   8   9   10   11   12   13   14   15   16   
Fri Oct 21 16:11:57 2022  -rsID Annotation for 3250 need to be fixed!
Fri Oct 21 16:11:57 2022  -Annotated 96750 rsID successfully!
Fri Oct 21 16:11:57 2022 Start to assign rsID using vcf...
Fri Oct 21 16:11:57 2022  -Current Dataframe shape : 100000  x  13
Fri Oct 21 16:11:57 2022  -CPU Cores to use : 3
Fri Oct 21 16:11:57 2022  -Reference VCF file: /Users/he/Documents/Mydata/All_20180423.vcf.gz
Fri Oct 21 16:11:57 2022  -Assigning rsID based on chr:pos and ref:alt/alt:ref...
Fri Oct 21 16:12:18 2022  -rsID Annotation for 582 need to be fixed!
Fri Oct 21 16:12:18 2022  -Annotated 2668 rsID successfully!
Fri Oct 21 16:12:18 2022 Start to sort the genome coordinates...
Fri Oct 21 16:12:18 2022  -Current Dataframe shape : 100000  x  13
Fri Oct 21 16:12:18 2022  -Force converting POS to integers...
Fri Oct 21 16:12:18 2022  -Sorting genome coordinates...
Fri Oct 21 16:12:18 2022 Finished sorting genome coordinates successfully!
Fri Oct 21 16:12:18 2022 Start to reorder the columns...
Fri Oct 21 16:12:18 2022  -Current Dataframe shape : 100000  x  13
Fri Oct 21 16:12:18 2022  -Reordering columns to    : SNPID,rsID,CHR,POS,EA,NEA,EAF,BETA,SE,P,N,DIRECTION,STATUS
Fri Oct 21 16:12:18 2022 Finished sorting columns successfully!
</code></pre></div></p>
<h2 id="sumstats-summary">Sumstats summary</h2>
<p>You can check the summary of your sumstats by:</p>
<div class="highlight"><pre><span></span><code>mysumstats.summary()
</code></pre></div>
<h2 id="format-and-output">Format and Output</h2>
<p>You can then foremat your sumstats and output.</p>
<p>gwaslab support commonly used formats. For details see: <a href="https://cloufield.github.io/gwaslab/Format/">https://cloufield.github.io/gwaslab/Format/</a>
<div class="highlight"><pre><span></span><code>mysumstats.to_format(&quot;clean_sumstats&quot;,fmt=&quot;ldsc&quot;)
</code></pre></div></p>
<hr />
<h2 id="liftover">Liftover</h2>
<div class="highlight"><pre><span></span><code><span class="n">mysumstats</span><span class="o">.</span><span class="n">liftover</span><span class="p">(</span><span class="n">n_cores</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">from_build</span><span class="o">=</span><span class="s2">&quot;19&quot;</span><span class="p">,</span> <span class="n">to_build</span><span class="o">=</span><span class="s2">&quot;38&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Gwaslab only liftover CHR and POS, and when lifted, the last two digits status code will be rolled back to 99. Since for difference reference genome, the reference allele or strand might be reverse, so it is need to align and check agin. </p>
<p>See details in <a href="../Harmonization/">Harmonization</a>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      GWASLab is licensed under the MIT license
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.51198bba.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>