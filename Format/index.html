<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="HE Yunye">
    
    <link rel="shortcut icon" href="../img/favicon.ico">

    
    <title>Format & Save - GWASLab</title>
    

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//rsms.me/inter/inter.css' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../css/base.min.css" rel="stylesheet">
    <link href="../css/cinder.min.css" rel="stylesheet">

    
        
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/github.min.css">
        
    

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]-->

    

     
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            
              <a class="navbar-brand" href="..">GWASLab</a>
            
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../Tutorial/">Tutorial</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Sumstats manipulation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../SumstatsObject/">SumstatsObject</a>
</li>

                        
                            
<li >
    <a href="../StatusCode/">StatusCode</a>
</li>

                        
                            
<li >
    <a href="../Standardization/">Standardization&normalization</a>
</li>

                        
                            
<li >
    <a href="../QC%26Filtering/">QC&Filtering</a>
</li>

                        
                            
<li >
    <a href="../Harmonization/">Harmonization</a>
</li>

                        
                            
<li >
    <a href="../LiftOver/">Liftover</a>
</li>

                        
                            
<li >
    <a href="../Conversion/">Data conversion</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Visualization <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../Visualization/">Manhattan & QQ plot</a>
</li>

                        
                            
<li >
    <a href="../RegionalPlot/">Regional Plot</a>
</li>

                        
                            
<li >
    <a href="../EffectSize/">Scatter: effect size comparison</a>
</li>

                        
                            
<li >
    <a href="../AlleleFrequency/">Scatter: allele frequency comparison</a>
</li>

                        
                            
<li >
    <a href="../GeneticCorrelation/">Heatmap: genetic correlation</a>
</li>

                        
                            
<li >
    <a href="../ForestPlot/">Forest Plot</a>
</li>

                        
                            
<li >
    <a href="../Gallery/">Gallery</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Utilities <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../ExtractLead/">Extract Lead Variants</a>
</li>

                        
                            
<li >
    <a href="../ExtractNovel/">Extract Novel Variants</a>
</li>

                        
                            
<li class="active">
    <a href="./">Format & Save</a>
</li>

                        
                            
<li >
    <a href="../LoadLDSC/">Load LDSC log</a>
</li>

                        
                            
<li >
    <a href="../HeritabilityConversion/">Convert Heritability</a>
</li>

                        
                            
<li >
    <a href="../InferBuild/">Infer Genome Build</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">References <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../Reference/">Reference data</a>
</li>

                        
                            
<li >
    <a href="../CommonData/">Common data</a>
</li>

                        
                            
<li >
    <a href="../UpdateLogs/">Update logs</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fas fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../ExtractNovel/">
                            <i class="fas fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../LoadLDSC/">
                            Next <i class="fas fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/Cloufield/gwaslab/"><i class="fab fa-github"></i> GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#output-sumstats-in-certain-formats">Output sumstats in certain formats</a></li>
            <li class="second-level"><a href="#example-1">Example 1:</a></li>
                
            <li class="second-level"><a href="#example-2-ldsc-format-extract-hapmap3-snps-and-exclude-snps-in-hla-region">Example 2: LDSC format, extract hapmap3 SNPs and exclude SNPs in HLA region</a></li>
                
            <li class="second-level"><a href="#example-3-bed-like-format">Example 3: bed-like format</a></li>
                
            <li class="second-level"><a href="#example-4-vcf-format">Example 4: vcf format</a></li>
                
            <li class="second-level"><a href="#example-5-gwas-ssf">Example 5: GWAS-ssf</a></li>
                
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="output-sumstats-in-certain-formats">Output sumstats in certain formats</h1>
<pre><code>to_format(
          path=&quot;./sumstats&quot;,
          fmt=&quot;ldsc&quot;,   
          extract=None,
          exclude=None,
          id_use=&quot;rsID&quot;,
          hapmap3=False,
          exclude_hla=False,  
          build=&quot;19&quot;, 
          verbose=True,
          output_log=True,
          to_csvargs={},
          float_formats={},
          xymt_number=False,
          xymt=[&quot;X&quot;,&quot;Y&quot;,&quot;MT&quot;],
          chr_prefix=None,
          bgzip=False,
          tabix=False
          )
</code></pre>
<ul>
<li><code>path</code> : <code>string</code>, the path for the output, only prefix is needed.</li>
<li><code>fmt</code>="ldsc": output format for sumstats. Currently support <code>plink</code> ,<code>plink2</code>, <code>ldsc</code>, <code>saige</code>, <code>fastgwa</code>, <code>regenie</code> . For details , please check <a href="https://github.com/Cloufield/formatbook"> https://github.com/Cloufield/formatbook</a>.</li>
<li><code>extract</code>:<code>list</code>, a list of variants to include.</li>
<li><code>exclude</code>:<code>list</code>, a list of variants to exclude.</li>
<li><code>id_use</code>:<code>string</code>, specify which ID to use when merging with Hapmap3 SNPs.</li>
<li><code>hapmap3</code>:<code>boolean</code> , if True, only output Hapmap3 SNPs.</li>
<li><code>exclude_hla</code>:<code>boolean</code> , if True, exclude variants in MHC region from output.</li>
<li><code>build</code> : <code>string</code>, reference genome build. </li>
<li><code>xymt_number</code> : if True, output chrX/Y/MT as 23/24/25.</li>
<li><code>xymt</code> : <code>list</code>, descript how to convert chromosome 23,24,25.</li>
<li><code>chr_prefix</code> : <code>string</code>, add a prefix to chromosomes when output chr. 6 -&gt; Chr6.</li>
<li><code>bgzip</code> : <code>boolean</code>, if True, bgzip the output file. Only works for bed format.</li>
<li><code>tabix</code> : <code>boolean</code>, if True, use tabix to index the bgzipped output file. Only works for bed format.</li>
<li><code>to_csvargs</code> : <code>dict</code> , extra parameters for pd.to_csv()</li>
<li><code>float_formats</code> : <code>dict</code>, a dictionary to specify the float format for each column.</li>
<li><code>verbose</code> : <code>boolean</code>, if True, print logs.</li>
<li><code>output_log</code> : <code>boolean</code>, if True, save log to a file.</li>
</ul>
<h2 id="example-1">Example 1:</h2>
<pre><code>import gwaslab as gl
# load your raw sumstats
mysumstats = gl.Sumstats(...)
# basic QC
mysumstats.basic_check()
# output metal format
mysumstats.to_format(&quot;./test&quot;,fmt=&quot;metal&quot;)
</code></pre>
<p>log :</p>
<pre><code>Tue Sep 13 18:00:41 2022 Start to format the output sumstats in:  metal  format
Tue Sep 13 18:00:41 2022  -Formatting statistics ...
Tue Sep 13 18:00:41 2022  - Float statistics formats:
Tue Sep 13 18:00:41 2022   - Columns: ['EAF', 'BETA', 'SE', 'P']
Tue Sep 13 18:00:41 2022   - Output formats: ['{:.4g}', '{:.4f}', '{:.4f}', '{:.4e}']
Tue Sep 13 18:00:41 2022  - Start outputting sumstats in metal format...
Tue Sep 13 18:00:41 2022  -metal format will be loaded...
Tue Sep 13 18:00:41 2022  -metal format meta info:
Tue Sep 13 18:00:41 2022   - format_name  :  metal
Tue Sep 13 18:00:41 2022   - format_source  :  https://genome.sph.umich.edu/wiki/METAL_Documentation
Tue Sep 13 18:00:41 2022   - format_version  :  20220726
Tue Sep 13 18:00:41 2022  -gwaslab to metal format dictionary:
Tue Sep 13 18:00:41 2022   - gwaslab keys: ['SNPID', 'EA', 'NEA', 'EAF', 'BETA', 'SE', 'P', 'DIRECTION']
Tue Sep 13 18:00:41 2022   - metal values: ['MarkerName', 'Allele1', 'Allele2', 'Freq1', 'Effect', 'StdErr', 'P-value', 'Direction']
Tue Sep 13 18:00:41 2022  -Output columns: Index(['MarkerName', 'Allele1', 'Allele2', 'Freq1', 'Effect', 'StdErr',
       'P-value'],
      dtype='object')
Tue Sep 13 18:00:41 2022  -Output path: ./test.metal.tsv.gz
Tue Sep 13 18:00:41 2022  -Saving log file: ./test.metal.log
Tue Sep 13 18:00:41 2022 Finished outputting successfully!
</code></pre>
<h2 id="example-2-ldsc-format-extract-hapmap3-snps-and-exclude-snps-in-hla-region">Example 2: LDSC format, extract hapmap3 SNPs and exclude SNPs in HLA region</h2>
<pre><code>## format the sumstats to ldsc format
## extract only hapmap3 SNPs
## exclude SNPs in HLA region
mysumstats.to_format(&quot;./test&quot;,fmt=&quot;ldsc&quot;, hapmap3=True, exclude_hla=False, build=&quot;19&quot;)
</code></pre>
<h2 id="example-3-bed-like-format">Example 3: bed-like format</h2>
<pre><code># output 1-based bed-like files for vep
mysumstats.to_format(&quot;./test&quot;,fmt=&quot;vep&quot;,xymt_number=True,chr_prefix=&quot;Chr&quot;)

# output 0-based bed-like file, and then bgzip and index the file.
mysumstats.to_format(&quot;./test&quot;,fmt=&quot;bed&quot;,bgzip=True,tabix=True)
</code></pre>
<h2 id="example-4-vcf-format">Example 4: vcf format</h2>
<pre><code># output vcf file, and then bgzip and index the file.
mysumstats.to_format(&quot;./test&quot;,fmt=&quot;vcf&quot;,bgzip=True,tabix=True)
</code></pre>
<h2 id="example-5-gwas-ssf">Example 5: GWAS-ssf</h2>
<pre><code># output  GWAS-ssf format
mysumstats.to_format(&quot;./test&quot;,fmt=&quot;ssf&quot;)
</code></pre>
<p>For sample codes, please check <a href="https://github.com/Cloufield/gwaslab/blob/main/examples/IO_format.ipynb">https://github.com/Cloufield/gwaslab/blob/main/examples/IO_format.ipynb</a></p></div>
        
        
    </div>

    
      <footer class="col-md-12 text-center">
          
          
            <hr>
            <p>
            <small>GWASLab is licensed under the MIT license</small><br>
            
            <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</small>
            </p>
          

          
          
      </footer>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>

    
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js"></script>
        
    <script>hljs.initHighlightingOnLoad();</script>
    

    <script>var base_url = ".."</script>
    
    <script src="../js/base.js"></script>
    <script src="../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    </body>

</html>
